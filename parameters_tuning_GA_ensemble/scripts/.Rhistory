trial_df$F1 = (2*(trial_df$precision * trial_df$recall) / (trial_df$precision + trial_df$recall))
trial_df[is.na(trial_df)] = 0
mean_F1 = mean(trial_df$F1)
sd_F1 = sd(trial_df$F1)
temp_df = data.frame(mean_F1 = c(mean_F1),
sd_F1 = c(sd_F1),
data_type = c(data_type))
if(stringr::str_split(temp_parameter, "_")[[1]][2] == 'split') {
temp_df$cluster_deviation = c(as.numeric(stringr::str_split(temp_parameter, "_")[[1]][4]))
} else {
temp_df$cluster_deviation = c(-as.numeric(stringr::str_split(temp_parameter, "_")[[1]][4]))
}
big_df = rbind(big_df, temp_df)
}
}
for(data_type in data_types) {
inferred_grn = read.csv(file.path("../../benchmark_network_inference_ensemble_BEELINE/output/curated_networks/", data_type, "/run_OneSC/curated_network_F1.csv"), row.names = 1)
gs_grn = read.csv(file.path("../input/gs", data_type, 'refNetwork.csv'))
precision = calc_precision(paste0(gs_grn$Gene1, "_" ,gs_grn$Gene2, "_", gs_grn$Type), paste0(inferred_grn$TF, "_", inferred_grn$TG, "_", inferred_grn$Type))
recall = calc_recall(paste0(gs_grn$Gene1, "_" ,gs_grn$Gene2, "_", gs_grn$Type), paste0(inferred_grn$TF, "_", inferred_grn$TG, "_", inferred_grn$Type))
F1 = (2*(precision * recall) / (precision + recall))
temp_df = data.frame(mean_F1 = c(F1),
sd_F1 = c(0),
data_type = c(data_type),
cluster_deviation = 0)
big_df = rbind(big_df, temp_df)
}
p = ggplot(big_df, aes(x = cluster_deviation, y = mean_F1)) +
geom_line() +
geom_errorbar(aes(ymin = mean_F1 - sd_F1, ymax = mean_F1 + sd_F1), width = .1) +
facet_wrap(~data_type, ncol = 2) +
ylab("Mean F1") +
xlab("Number of Clusters Deviation") +
theme_half_open()
ggsave(filename = '../output/screen_cluster_assignment/cluster_deivation_performance.png', plot = p, width = 10, height = 7)
library(ggplot2)
library(stringr)
library(ggsignif)
library(cowplot)
library(dplyr)
calc_precision <- function(gs_edges, inferred_edges) {
num_TP = length(intersect(gs_edges, inferred_edges))
num_FP = length(setdiff(inferred_edges, gs_edges))
return(num_TP / (num_TP + num_FP))
}
calc_recall <- function(gs_edges, inferred_edges) {
num_TP = length(intersect(gs_edges, inferred_edges))
num_FN = length(setdiff(gs_edges, inferred_edges))
return(num_TP / (num_TP + num_FN))
}
data_types = list.dirs("../input/gs", recursive = FALSE, full.name = FALSE)
parameter_sweep_list = list.dirs("../output/screen_density", recursive = FALSE, full.name = FALSE)
big_df = data.frame()
for(temp_parameter in parameter_sweep_list) {
for(data_type in data_types) {
gs_grn = read.csv(file.path("../input/gs", data_type, 'refNetwork.csv'))
inferred_grn = read.csv(file.path("../output/screen_density", temp_parameter, data_type, paste0("OneSC_network.csv")))
inferred_grn$X = NULL
temp_df = data.frame(row.names = c(data_type))
temp_df$data_type = c(data_type)
temp_df$parameter = c(temp_parameter)
temp_df$precision = NA
temp_df$recall = NA
temp_df[data_type, 'precision'] = calc_precision(paste0(gs_grn$Gene1, "_" ,gs_grn$Gene2, "_", gs_grn$Type), paste0(inferred_grn$TF, "_", inferred_grn$TG, "_", inferred_grn$Type))
temp_df[data_type, 'recall'] = calc_recall(paste0(gs_grn$Gene1, "_" ,gs_grn$Gene2, "_", gs_grn$Type), paste0(inferred_grn$TF, "_", inferred_grn$TG, "_", inferred_grn$Type))
big_df = rbind(big_df, temp_df)
}
}
big_df$F1 = NA
big_df$F1 = (2*(big_df$precision * big_df$recall) / (big_df$precision + big_df$recall))
p <- ggplot(big_df, aes(x=parameter, y=F1)) +
geom_boxplot()+
theme_half_open() +
ylab("F1 Score") +
xlab("Ideal Network Density Parameter") +
ylim(c(0, 1)) +
ggtitle('OneSC GRNs from multiple ideal network density') +
theme(axis.text.x = element_text(angle = 45, vjust = 0.9, hjust=1))
ggsave(filename = '../output/screen_density/F1_comparison.png', plot = p, width = 10, height = 4)
library(ggplot2)
library(stringr)
library(ggsignif)
library(cowplot)
library(dplyr)
calc_precision <- function(gs_edges, inferred_edges) {
num_TP = length(intersect(gs_edges, inferred_edges))
num_FP = length(setdiff(inferred_edges, gs_edges))
return(num_TP / (num_TP + num_FP))
}
calc_recall <- function(gs_edges, inferred_edges) {
num_TP = length(intersect(gs_edges, inferred_edges))
num_FN = length(setdiff(gs_edges, inferred_edges))
return(num_TP / (num_TP + num_FN))
}
data_types = list.dirs("../output/screen_cluster_assignment/", recursive = FALSE, full.name = FALSE)
big_df = data.frame()
for(data_type in data_types) {
gs_grn = read.csv(file.path("../input/gs", data_type, 'refNetwork.csv'))
parameter_sweep_list = list.dirs(file.path("../output/screen_cluster_assignment", data_type), recursive = FALSE, full.name = FALSE)
for(temp_parameter in parameter_sweep_list) {
trial_list = list.dirs(file.path("../output/screen_cluster_assignment", data_type, temp_parameter), recursive = FALSE, full.name = FALSE)
trial_df = data.frame(row.names = trial_list)
trial_df['precision'] = NA
trial_df['recall'] = NA
for(temp_trial in trial_list) {
print(temp_trial)
inferred_grn = read.csv(file.path("../output/screen_cluster_assignment", data_type, temp_parameter, temp_trial, paste0("OneSC_network.csv")))
inferred_grn$X = NULL
trial_df[temp_trial, 'precision'] = calc_precision(paste0(gs_grn$Gene1, "_" ,gs_grn$Gene2, "_", gs_grn$Type), paste0(inferred_grn$TF, "_", inferred_grn$TG, "_", gs_grn$Type))
trial_df[temp_trial, 'recall'] = calc_recall(paste0(gs_grn$Gene1, "_" ,gs_grn$Gene2, "_", gs_grn$Type), paste0(inferred_grn$TF, "_", inferred_grn$TG, "_", gs_grn$Type))
}
trial_df$F1 = NA
trial_df$F1 = (2*(trial_df$precision * trial_df$recall) / (trial_df$precision + trial_df$recall))
trial_df[is.na(trial_df)] = 0
mean_F1 = mean(trial_df$F1)
sd_F1 = sd(trial_df$F1)
temp_df = data.frame(mean_F1 = c(mean_F1),
sd_F1 = c(sd_F1),
data_type = c(data_type))
if(stringr::str_split(temp_parameter, "_")[[1]][2] == 'split') {
temp_df$cluster_deviation = c(as.numeric(stringr::str_split(temp_parameter, "_")[[1]][4]))
} else {
temp_df$cluster_deviation = c(-as.numeric(stringr::str_split(temp_parameter, "_")[[1]][4]))
}
big_df = rbind(big_df, temp_df)
}
}
for(data_type in data_types) {
inferred_grn = read.csv(file.path("../../benchmark_network_inference_ensemble_BEELINE/output/curated_networks/", data_type, "/run_OneSC/curated_network_F1.csv"), row.names = 1)
gs_grn = read.csv(file.path("../input/gs", data_type, 'refNetwork.csv'))
precision = calc_precision(paste0(gs_grn$Gene1, "_" ,gs_grn$Gene2, "_", gs_grn$Type), paste0(inferred_grn$TF, "_", inferred_grn$TG, "_", inferred_grn$Type))
recall = calc_recall(paste0(gs_grn$Gene1, "_" ,gs_grn$Gene2, "_", gs_grn$Type), paste0(inferred_grn$TF, "_", inferred_grn$TG, "_", inferred_grn$Type))
F1 = (2*(precision * recall) / (precision + recall))
temp_df = data.frame(mean_F1 = c(F1),
sd_F1 = c(0),
data_type = c(data_type),
cluster_deviation = 0)
big_df = rbind(big_df, temp_df)
}
View(gs_grn)
View(big_df)
library(ggplot2)
library(stringr)
library(ggsignif)
library(cowplot)
library(dplyr)
calc_precision <- function(gs_edges, inferred_edges) {
num_TP = length(intersect(gs_edges, inferred_edges))
num_FP = length(setdiff(inferred_edges, gs_edges))
return(num_TP / (num_TP + num_FP))
}
calc_recall <- function(gs_edges, inferred_edges) {
num_TP = length(intersect(gs_edges, inferred_edges))
num_FN = length(setdiff(gs_edges, inferred_edges))
return(num_TP / (num_TP + num_FN))
}
data_types = list.dirs("../input/gs", recursive = FALSE, full.name = FALSE)
parameter_sweep_list = list.dirs("../output/screen_density", recursive = FALSE, full.name = FALSE)
big_df = data.frame()
for(temp_parameter in parameter_sweep_list) {
for(data_type in data_types) {
gs_grn = read.csv(file.path("../input/gs", data_type, 'refNetwork.csv'))
inferred_grn = read.csv(file.path("../output/screen_density", temp_parameter, data_type, paste0("OneSC_network.csv")))
inferred_grn$X = NULL
temp_df = data.frame(row.names = c(data_type))
temp_df$data_type = c(data_type)
temp_df$parameter = c(temp_parameter)
temp_df$precision = NA
temp_df$recall = NA
temp_df[data_type, 'precision'] = calc_precision(paste0(gs_grn$Gene1, "_" ,gs_grn$Gene2, "_", gs_grn$Type), paste0(inferred_grn$TF, "_", inferred_grn$TG, "_", inferred_grn$Type))
temp_df[data_type, 'recall'] = calc_recall(paste0(gs_grn$Gene1, "_" ,gs_grn$Gene2, "_", gs_grn$Type), paste0(inferred_grn$TF, "_", inferred_grn$TG, "_", inferred_grn$Type))
big_df = rbind(big_df, temp_df)
}
}
big_df$F1 = NA
big_df$F1 = (2*(big_df$precision * big_df$recall) / (big_df$precision + big_df$recall))
colnames(big_df)
big_df %>%
group_by(parameter) %>%
summarize(mean_F1 = mean(F1))
big_df %>%
group_by(parameter) %>%
summarize(mean_F1 = median(F1))
big_df %>%
group_by(parameter) %>%
summarize(mean_F1 = mean(F1))
big_df %>%
group_by(parameter) %>%
summarize(mean_F1 = mean(F1)) %>%
arrange(mean_F1)
library(ggplot2)
library(stringr)
library(ggsignif)
library(cowplot)
library(dplyr)
library(viridis)
calc_precision <- function(gs_edges, inferred_edges) {
num_TP = length(intersect(gs_edges, inferred_edges))
num_FP = length(setdiff(inferred_edges, gs_edges))
return(num_TP / (num_TP + num_FP))
}
calc_recall <- function(gs_edges, inferred_edges) {
num_TP = length(intersect(gs_edges, inferred_edges))
num_FN = length(setdiff(gs_edges, inferred_edges))
return(num_TP / (num_TP + num_FN))
}
parameter_sweep_list = list.dirs("../output/screen_generations_finer/", recursive = FALSE, full.name = FALSE)
big_df = data.frame()
for(temp_parameter in parameter_sweep_list) {
temp_param_df = data.frame()
for(data_type in data_types) {
gs_grn = read.csv(file.path("../input/gs", data_type, 'refNetwork.csv'))
inferred_grn = read.csv(file.path("../output/screen_generations", temp_parameter, data_type, paste0("OneSC_network.csv")))
inferred_grn$X = NULL
string_split_list = stringr::str_split(temp_parameter, "_")[[1]]
temp_df = data.frame(row.names = c(data_type))
temp_df$data_type = c(data_type)
temp_df$num_generation = c(string_split_list[2])
temp_df$max_iter = c(string_split_list[4])
temp_df$precision = NA
temp_df$recall = NA
temp_df[data_type, 'precision'] = calc_precision(paste0(gs_grn$Gene1, "_" ,gs_grn$Gene2, "_", gs_grn$Type), paste0(inferred_grn$TF, "_", inferred_grn$TG, "_", inferred_grn$Type))
temp_df[data_type, 'recall'] = calc_recall(paste0(gs_grn$Gene1, "_" ,gs_grn$Gene2, "_", gs_grn$Type), paste0(inferred_grn$TF, "_", inferred_grn$TG, "_", inferred_grn$Type))
temp_param_df = rbind(temp_param_df, temp_df)
}
temp_param_df$F1 = NA
temp_param_df$F1 = (2*(temp_param_df$precision * temp_param_df$recall) / (temp_param_df$precision + temp_param_df$recall))
temp_param_df = temp_param_df[temp_param_df$data_type != 'dyn-CY', ]
additional_df = data.frame(row.names = c(temp_parameter))
additional_df$num_generation = c(string_split_list[2])
additional_df$max_iter = c(string_split_list[4])
additional_df$mean_F1 = mean(temp_param_df$F1)
additional_df$sd_F1 = sd(temp_param_df$F1)
big_df = rbind(big_df, additional_df)
}
data_types = list.dirs("../input/gs", recursive = FALSE, full.name = FALSE)
parameter_sweep_list = list.dirs("../output/screen_generations_finer/", recursive = FALSE, full.name = FALSE)
big_df = data.frame()
for(temp_parameter in parameter_sweep_list) {
temp_param_df = data.frame()
for(data_type in data_types) {
gs_grn = read.csv(file.path("../input/gs", data_type, 'refNetwork.csv'))
inferred_grn = read.csv(file.path("../output/screen_generations", temp_parameter, data_type, paste0("OneSC_network.csv")))
inferred_grn$X = NULL
string_split_list = stringr::str_split(temp_parameter, "_")[[1]]
temp_df = data.frame(row.names = c(data_type))
temp_df$data_type = c(data_type)
temp_df$num_generation = c(string_split_list[2])
temp_df$max_iter = c(string_split_list[4])
temp_df$precision = NA
temp_df$recall = NA
temp_df[data_type, 'precision'] = calc_precision(paste0(gs_grn$Gene1, "_" ,gs_grn$Gene2, "_", gs_grn$Type), paste0(inferred_grn$TF, "_", inferred_grn$TG, "_", inferred_grn$Type))
temp_df[data_type, 'recall'] = calc_recall(paste0(gs_grn$Gene1, "_" ,gs_grn$Gene2, "_", gs_grn$Type), paste0(inferred_grn$TF, "_", inferred_grn$TG, "_", inferred_grn$Type))
temp_param_df = rbind(temp_param_df, temp_df)
}
temp_param_df$F1 = NA
temp_param_df$F1 = (2*(temp_param_df$precision * temp_param_df$recall) / (temp_param_df$precision + temp_param_df$recall))
temp_param_df = temp_param_df[temp_param_df$data_type != 'dyn-CY', ]
additional_df = data.frame(row.names = c(temp_parameter))
additional_df$num_generation = c(string_split_list[2])
additional_df$max_iter = c(string_split_list[4])
additional_df$mean_F1 = mean(temp_param_df$F1)
additional_df$sd_F1 = sd(temp_param_df$F1)
big_df = rbind(big_df, additional_df)
}
big_df = data.frame()
for(temp_parameter in parameter_sweep_list) {
temp_param_df = data.frame()
for(data_type in data_types) {
gs_grn = read.csv(file.path("../input/gs", data_type, 'refNetwork.csv'))
inferred_grn = read.csv(file.path("../output/screen_generations_finer", temp_parameter, data_type, paste0("OneSC_network.csv")))
inferred_grn$X = NULL
string_split_list = stringr::str_split(temp_parameter, "_")[[1]]
temp_df = data.frame(row.names = c(data_type))
temp_df$data_type = c(data_type)
temp_df$num_generation = c(string_split_list[2])
temp_df$max_iter = c(string_split_list[4])
temp_df$precision = NA
temp_df$recall = NA
temp_df[data_type, 'precision'] = calc_precision(paste0(gs_grn$Gene1, "_" ,gs_grn$Gene2, "_", gs_grn$Type), paste0(inferred_grn$TF, "_", inferred_grn$TG, "_", inferred_grn$Type))
temp_df[data_type, 'recall'] = calc_recall(paste0(gs_grn$Gene1, "_" ,gs_grn$Gene2, "_", gs_grn$Type), paste0(inferred_grn$TF, "_", inferred_grn$TG, "_", inferred_grn$Type))
temp_param_df = rbind(temp_param_df, temp_df)
}
temp_param_df$F1 = NA
temp_param_df$F1 = (2*(temp_param_df$precision * temp_param_df$recall) / (temp_param_df$precision + temp_param_df$recall))
temp_param_df = temp_param_df[temp_param_df$data_type != 'dyn-CY', ]
additional_df = data.frame(row.names = c(temp_parameter))
additional_df$num_generation = c(string_split_list[2])
additional_df$max_iter = c(string_split_list[4])
additional_df$mean_F1 = mean(temp_param_df$F1)
additional_df$sd_F1 = sd(temp_param_df$F1)
big_df = rbind(big_df, additional_df)
}
big_df = big_df[big_df$num_generation != 50, ]
p = ggplot(big_df, aes(num_generation, max_iter, fill= mean_F1)) +
geom_tile() +
ylab("Max Number of Iterations") +
xlab("Number of Generations") +
scale_fill_viridis(discrete=FALSE) +
guides(fill=guide_legend(title="Mean F1")) +
theme_half_open()
p
big_df$max_iter = factor(x = big_df$max_iter, levels = c(5, 10, 15, 20, 25, 30))
p = ggplot(big_df, aes(num_generation, max_iter, fill= mean_F1)) +
geom_tile() +
ylab("Max Number of Iterations") +
xlab("Number of Generations") +
scale_fill_viridis(discrete=FALSE) +
guides(fill=guide_legend(title="Mean F1")) +
theme_half_open()
p
library(ggplot2)
library(stringr)
library(ggsignif)
library(cowplot)
library(dplyr)
library(viridis)
calc_precision <- function(gs_edges, inferred_edges) {
num_TP = length(intersect(gs_edges, inferred_edges))
num_FP = length(setdiff(inferred_edges, gs_edges))
return(num_TP / (num_TP + num_FP))
}
calc_recall <- function(gs_edges, inferred_edges) {
num_TP = length(intersect(gs_edges, inferred_edges))
num_FN = length(setdiff(gs_edges, inferred_edges))
return(num_TP / (num_TP + num_FN))
}
data_types = list.dirs("../input/gs", recursive = FALSE, full.name = FALSE)
parameter_sweep_list = list.dirs("../output/screen_generations/", recursive = FALSE, full.name = FALSE)
big_df = data.frame()
for(temp_parameter in parameter_sweep_list) {
temp_param_df = data.frame()
for(data_type in data_types) {
gs_grn = read.csv(file.path("../input/gs", data_type, 'refNetwork.csv'))
inferred_grn = read.csv(file.path("../output/screen_generations", temp_parameter, data_type, paste0("OneSC_network.csv")))
inferred_grn$X = NULL
string_split_list = stringr::str_split(temp_parameter, "_")[[1]]
temp_df = data.frame(row.names = c(data_type))
temp_df$data_type = c(data_type)
temp_df$num_generation = c(string_split_list[2])
temp_df$max_iter = c(string_split_list[4])
temp_df$precision = NA
temp_df$recall = NA
temp_df[data_type, 'precision'] = calc_precision(paste0(gs_grn$Gene1, "_" ,gs_grn$Gene2, "_", gs_grn$Type), paste0(inferred_grn$TF, "_", inferred_grn$TG, "_", inferred_grn$Type))
temp_df[data_type, 'recall'] = calc_recall(paste0(gs_grn$Gene1, "_" ,gs_grn$Gene2, "_", gs_grn$Type), paste0(inferred_grn$TF, "_", inferred_grn$TG, "_", inferred_grn$Type))
temp_param_df = rbind(temp_param_df, temp_df)
}
temp_param_df$F1 = NA
temp_param_df$F1 = (2*(temp_param_df$precision * temp_param_df$recall) / (temp_param_df$precision + temp_param_df$recall))
temp_param_df = temp_param_df[temp_param_df$data_type != 'dyn-CY', ]
additional_df = data.frame(row.names = c(temp_parameter))
additional_df$num_generation = c(string_split_list[2])
additional_df$max_iter = c(string_split_list[4])
additional_df$mean_F1 = mean(temp_param_df$F1)
additional_df$sd_F1 = sd(temp_param_df$F1)
big_df = rbind(big_df, additional_df)
}
big_df = big_df[big_df$num_generation != 50, ]
big_df$max_iter = factor(x = big_df$max_iter, levels = c(5, 10, 15, 20, 25, 30))
p = ggplot(big_df, aes(num_generation, max_iter, fill= mean_F1)) +
geom_tile() +
ylab("Max Number of Iterations") +
xlab("Number of Generations") +
scale_fill_viridis(discrete=FALSE) +
guides(fill=guide_legend(title="Mean F1")) +
theme_half_open()
p
sub_df = big_df[big_df$max_iter == 10, ]
sub_df$num_generation = as.numeric(sub_df$num_generation)
sub_df$mean_F1 = as.numeric(sub_df$mean_F1)
p = ggplot(sub_df, aes(x = num_generation, y = mean_F1)) +
geom_line() +
geom_point() +
ylab("Mean F1") +
xlab("Number of Generations") +
ylim(c(0, 1)) +
theme_half_open() +
ggtitle("Mean F1 across different number of generations parameter")
p = ggplot(sub_df, aes(x = num_generation, y = mean_F1)) +
geom_line() +
geom_point() +
ylab("Mean F1") +
xlab("Number of Generations") +
#ylim(c(0, 1)) +
theme_half_open() +
ggtitle("Mean F1 across different number of generations parameter")
p
ggsave(filename = '../output/screen_generations_finer/F1_generations.png', plot = p, width = 8, height = 8)
sub_df = big_df[big_df$max_iter == 10, ]
sub_df$num_generation = as.numeric(sub_df$num_generation)
sub_df$mean_F1 = as.numeric(sub_df$mean_F1)
p = ggplot(sub_df, aes(x = num_generation, y = mean_F1)) +
geom_line() +
geom_point() +
ylab("Mean F1") +
xlab("Number of Generations") +
ylim(c(0, 1)) +
theme_half_open() +
ggtitle("Mean F1 across different number of generations parameter")
p
p = ggplot(sub_df, aes(x = num_generation, y = mean_F1)) +
geom_line() +
geom_point() +
ylab("Mean F1") +
xlab("Number of Generations") +
#ylim(c(0, 1)) +
theme_half_open() +
ggtitle("Mean F1 across different number of generations parameter")
p
library(ggplot2)
library(stringr)
library(ggsignif)
library(cowplot)
library(dplyr)
library(viridis)
calc_precision <- function(gs_edges, inferred_edges) {
num_TP = length(intersect(gs_edges, inferred_edges))
num_FP = length(setdiff(inferred_edges, gs_edges))
return(num_TP / (num_TP + num_FP))
}
calc_recall <- function(gs_edges, inferred_edges) {
num_TP = length(intersect(gs_edges, inferred_edges))
num_FN = length(setdiff(gs_edges, inferred_edges))
return(num_TP / (num_TP + num_FN))
}
data_types = list.dirs("../input/gs", recursive = FALSE, full.name = FALSE)
parameter_sweep_list = list.dirs("../output/screen_generations_finer/", recursive = FALSE, full.name = FALSE)
big_df = data.frame()
for(temp_parameter in parameter_sweep_list) {
temp_param_df = data.frame()
for(data_type in data_types) {
gs_grn = read.csv(file.path("../input/gs", data_type, 'refNetwork.csv'))
inferred_grn = read.csv(file.path("../output/screen_generations_finer", temp_parameter, data_type, paste0("OneSC_network.csv")))
inferred_grn$X = NULL
string_split_list = stringr::str_split(temp_parameter, "_")[[1]]
temp_df = data.frame(row.names = c(data_type))
temp_df$data_type = c(data_type)
temp_df$num_generation = c(string_split_list[2])
temp_df$max_iter = c(string_split_list[4])
temp_df$precision = NA
temp_df$recall = NA
temp_df[data_type, 'precision'] = calc_precision(paste0(gs_grn$Gene1, "_" ,gs_grn$Gene2, "_", gs_grn$Type), paste0(inferred_grn$TF, "_", inferred_grn$TG, "_", inferred_grn$Type))
temp_df[data_type, 'recall'] = calc_recall(paste0(gs_grn$Gene1, "_" ,gs_grn$Gene2, "_", gs_grn$Type), paste0(inferred_grn$TF, "_", inferred_grn$TG, "_", inferred_grn$Type))
temp_param_df = rbind(temp_param_df, temp_df)
}
temp_param_df$F1 = NA
temp_param_df$F1 = (2*(temp_param_df$precision * temp_param_df$recall) / (temp_param_df$precision + temp_param_df$recall))
temp_param_df = temp_param_df[temp_param_df$data_type != 'dyn-CY', ]
additional_df = data.frame(row.names = c(temp_parameter))
additional_df$num_generation = c(string_split_list[2])
additional_df$max_iter = c(string_split_list[4])
additional_df$mean_F1 = mean(temp_param_df$F1)
additional_df$sd_F1 = sd(temp_param_df$F1)
big_df = rbind(big_df, additional_df)
}
big_df = big_df[big_df$num_generation != 50, ]
big_df$max_iter = factor(x = big_df$max_iter, levels = c(5, 10, 15, 20, 25, 30))
p = ggplot(big_df, aes(num_generation, max_iter, fill= mean_F1)) +
geom_tile() +
ylab("Max Number of Iterations") +
xlab("Number of Generations") +
scale_fill_viridis(discrete=FALSE) +
guides(fill=guide_legend(title="Mean F1")) +
theme_half_open()
p
sub_df = big_df[big_df$max_iter == 10, ]
sub_df$num_generation = as.numeric(sub_df$num_generation)
sub_df$mean_F1 = as.numeric(sub_df$mean_F1)
p = ggplot(sub_df, aes(x = num_generation, y = mean_F1)) +
geom_line() +
geom_point() +
ylab("Mean F1") +
xlab("Number of Generations") +
#ylim(c(0, 1)) +
theme_half_open() +
ggtitle("Mean F1 across different number of generations parameter")
p
sub_df = time_big_df[time_big_df$max_iter == 10, ]
sub_df$num_gen = as.numeric(sub_df$num_gen)
sub_df$mean_time = as.numeric(sub_df$mean_time)
p = ggplot(sub_df, aes(x = num_gen, y = mean_time)) +
geom_line() +
geom_point() +
ylab("Mean Run Time (Sec)") +
xlab("Number of Generations") +
theme_half_open() +
ggtitle("Mean run time across different number of generations parameter")
p
time_big_df = read.csv("../output/screen_generations_finer/generation_time_big_df.csv", row.names = 1)
time_big_df = time_big_df[time_big_df$num_gen != 50, ]
time_big_df$max_iter = as.character(time_big_df$max_iter)
time_big_df$num_gen = as.character(time_big_df$num_gen)
time_big_df$max_iter = factor(x = time_big_df$max_iter, levels = c(5, 10, 15, 20, 25, 30))
p = ggplot(time_big_df, aes(num_gen, max_iter, fill= mean_time)) +
geom_tile() +
ylab("Max Number of Iterations") +
xlab("Number of Generations") +
scale_fill_viridis(discrete=FALSE) +
guides(fill=guide_legend(title="Mean RunTime(Sec)")) +
theme_half_open()
p
sub_df = time_big_df[time_big_df$max_iter == 10, ]
sub_df$num_gen = as.numeric(sub_df$num_gen)
sub_df$mean_time = as.numeric(sub_df$mean_time)
p = ggplot(sub_df, aes(x = num_gen, y = mean_time)) +
geom_line() +
geom_point() +
ylab("Mean Run Time (Sec)") +
xlab("Number of Generations") +
theme_half_open() +
ggtitle("Mean run time across different number of generations parameter")
p
